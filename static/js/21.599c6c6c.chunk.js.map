{"version":3,"sources":["modals/UnbondingModal.js"],"names":["customStyles","content","top","left","right","bottom","marginRight","width","height","transform","backgroundColor","borderRadius","padding","UnbondingModal","props","useState","inputBalance","setinputBalance","isUnbondButtonEnabled","SetIsUnbondButtonEnabled","isUnbonding","setIsUnbonding","secretjs","address","wallet","setWallet","a","setupKeplr","amount","String","parseInt","process","tx","compute","executeContract","sender","contractAddress","codeHash","msg","request_withdraw","gasLimit","Notifications","transactionHash","clearfields","onInputchange","e","target","value","callback","hide","useEffect","setupKeplrfun","delegated","UM","isShowing","ReactDOM","createPortal","Fragment","isOpen","onRequestClose","contentLabel","style","ariaHideApp","className","type","aria-label","onClick","src","logo","alt","min","placeholder","placeholder-default","name","onChange","toFixed","unbond","disabled","document","body"],"mappings":"kRAQMA,EAAe,CACnBC,QAAS,CACPC,IAAK,MACLC,KAAM,MACNC,MAAO,OACPC,OAAQ,OACRC,YAAa,OACbC,MAAO,MACPC,OAAQ,MACRC,UAAW,wBACXC,gBAAiB,UACjBC,aAAc,KACdC,QAAS,OA+OEC,UA3Of,SAAwBC,GAAO,MAKSC,mBAAS,GALlB,mBAKxBC,EALwB,KAKVC,EALU,OAM2BF,oBAAS,GANpC,mBAMxBG,EANwB,KAMDC,EANC,OAOOJ,oBAAS,GAPhB,mBAOxBK,EAPwB,KAOXC,EAPW,OASHN,mBAAS,CAAEO,SAAU,KAAMC,QAAS,OATjC,mBASxBC,EATwB,KAShBC,EATgB,iDAW7B,gCAAAC,EAAA,sEACsCC,cADtC,gBACUL,EADV,EACUA,SAAUC,EADpB,EACoBA,QAClBE,EAAU,CAAEH,WAAUC,YAFxB,4CAX6B,kEAgB7B,kCAAAG,EAAA,6DACEL,GAAe,GAEPC,EAAsBE,EAAtBF,SAAUC,EAAYC,EAAZD,QAEdK,EAASC,OAAOC,SAAwB,IAAfd,IACPe,gDACPA,mEAPjB,kBAUqBT,EAASU,GAAGC,QAAQC,gBACnC,CACEC,OAAQZ,EACRa,gBAPgBL,gDAQhBM,SAPSN,mEAQTO,IAAK,CACHC,iBAAkB,CAAEX,OAAQA,KAGhC,CACEY,SAAU,SApBlB,OAUUR,EAVV,OAyBIS,YACE,UACA,oBAFW,iCAGezB,EAHf,sCAIDgB,EAAGU,kBA7BnB,kDAgCID,YAAc,QAAS,QAAV,MAhCjB,yBAmCQE,IAnCR,2DAhB6B,+BAsEdC,EAtEc,8EAsE7B,WAA6BC,GAA7B,SAAAnB,EAAA,sDACET,EAAgB4B,EAAEC,OAAOC,OAD3B,4CAtE6B,+BA0EdJ,IA1Ec,2EA0E7B,sBAAAjB,EAAA,sEACQZ,EAAMkC,WADd,OAEElC,EAAMmC,OACNhC,EAAgB,GAChBI,GAAe,GAJjB,4CA1E6B,sBAsD7B6B,qBAAU,WACe,MAAnB1B,EAAOF,UAAsC,MAAlBE,EAAOD,SAvDX,mCAwDzB4B,GAIAhC,EADkB,GAAhBH,GAMe,IAAfA,EAAqBF,EAAMsC,WAC7BjC,GAAyB,KAE1B,CAACK,EAAQR,EAAcF,EAAMsC,YAahC,IAAMC,EAAK,SAAC,GAAD,IAAGC,EAAH,EAAGA,UAAWL,EAAd,EAAcA,KAAd,OACTK,EACIC,IAASC,aACP,kBAAC,IAAMC,SAAP,KACE,kBAAC,IAAD,CACEC,OAAQJ,EACRK,eAAgBV,EAChBW,aAAa,gBACbC,MAAO7D,EACP8D,aAAa,GAEb,yBAAKC,UAAU,wCACb,6BACE,yBAAKA,UAAU,8CACb,yBAAKA,UAAU,IACb,0BAAMA,UAAU,yBAAhB,WAEF,yBAAKA,UAAU,mBACb,4BACEC,KAAK,SACLD,UAAU,kBACVE,aAAW,QACXC,QAASvB,OAMjB,yBAAKoB,UAAU,sEACb,0BAAMA,UAAU,yBAAhB,8HAMF,yBAAKA,UAAU,2DACb,yBAAKA,UAAU,wBACb,0BAAMA,UAAU,yBAAhB,WAEF,yBAAKA,UAAU,IACb,yBAAKA,UAAU,MAAf,6CAEE,yBAAKA,UAAU,MAAf,yCAGA,yBAAKA,UAAU,MAAf,yDAON,yBAAKA,UAAU,oDACb,yBAAKA,UAAU,IACb,0BAAMA,UAAU,kCAAhB,cAIF,yBAAKA,UAAU,kBACb,yBAAKA,UAAU,iCACb,yBACEI,IAAKC,IACLC,IAAI,aACJN,UAAU,8BAGd,yBAAKA,UAAU,6BACZjD,EAAMsC,UAAY,IADrB,WAMJ,yBACEW,UAAU,wHAGV,6BACE,2BACEA,UAAU,gDACVC,KAAK,SACLM,IAAI,IACJC,YAAY,OACZC,sBAAoB,QACpBC,KAAK,eACL1B,MAAO/B,EACP0D,SAAU9B,KAGd,yBAAKmB,UAAU,sCAAf,SAEF,yBAAKA,UAAU,+DACb,yBACEA,UAAU,wCACVG,QAAS,WACPjD,GACIH,EAAMsC,UAAY,IAAO,KAAMuB,QAAQ,MAI7C,wCAEF,yBACEZ,UAAU,wCACVG,QAAS,WACPjD,GACIH,EAAMsC,UAAY,IAAO,IAAKuB,QAAQ,MAI5C,wCAEF,yBACEZ,UAAU,wCACVG,QAAS,WACPjD,GACIH,EAAMsC,UAAY,IAAO,KAAMuB,QAAQ,MAI7C,wCAEF,yBACEZ,UAAU,wCACVG,QAAS,WACPjD,GAAiBH,EAAMsC,UAAY,KAAKuB,QAAQ,MAGlD,0CAGJ,yBAAKZ,UAAU,WACb,kBAAC,SAAD,CACEA,UAAU,oDACVG,QAAS,kBAtNE,0CAsNIU,IACfC,UAAW3D,GAEVE,EACC,yBAAK2C,UAAU,mBACb,oCAGF,4CAOZe,SAASC,MAEX,MACN,OAAO,kBAAC1B,EAAD,CAAIC,UAAWxC,EAAMwC,UAAWL,KAAMnC,EAAMmC","file":"static/js/21.599c6c6c.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Modal from \"react-modal\";\nimport { Button } from \"@windmill/react-ui\";\nimport logo from \"../assets/img/scrt_logo.png\"; // with import\nimport { setupKeplr } from \"../components/CryptoComponents/client\";\nimport ReactDOM from \"react-dom\";\nimport Notifications from \"../utils/demo/notifications.js\";\n\nconst customStyles = {\n  content: {\n    top: \"50%\",\n    left: \"50%\",\n    right: \"auto\",\n    bottom: \"auto\",\n    marginRight: \"-50%\",\n    width: \"40%\",\n    height: \"60%\",\n    transform: \"translate(-50%, -50%)\",\n    backgroundColor: \"#0f4d4a\",\n    borderRadius: \"1%\",\n    padding: \"2%\",\n  },\n};\n\nfunction UnbondingModal(props) {\n  //fetch the balance\n  //create a state where you fetch secretjs once + the address\n  //\n\n  let [inputBalance, setinputBalance] = useState(0);\n  let [isUnbondButtonEnabled, SetIsUnbondButtonEnabled] = useState(false);\n  let [isUnbonding, setIsUnbonding] = useState(false);\n\n  let [wallet, setWallet] = useState({ secretjs: null, address: null });\n\n  async function setupKeplrfun() {\n    const { secretjs, address } = await setupKeplr();\n    setWallet({ secretjs, address });\n  }\n\n  async function unbond() {\n    setIsUnbonding(true);\n    // To create a readonly secret.js client, just pass in a gRPC-web endpoint\n    const { secretjs, address } = wallet;\n\n    let amount = String(parseInt(inputBalance * 1e6));\n    let contractAddress = process.env.REACT_APP_POOL_CONTRACT_ADDRESS;\n    let codeHash = process.env.REACT_APP_POOL_CONTRACT_HASH;\n\n    try {\n      const tx = await secretjs.tx.compute.executeContract(\n        {\n          sender: address,\n          contractAddress: contractAddress,\n          codeHash: codeHash, // optional but way faster\n          msg: {\n            request_withdraw: { amount: amount },\n          },\n        },\n        {\n          gasLimit: 240297,\n        }\n      );\n\n      // fetchDelegated();\n      Notifications(\n        \"success\",\n        \"Transaction sent!\",\n        `Successfully Unbonded: ${inputBalance} SCRT \\n \n        Txhash: ${tx.transactionHash}`\n      );\n    } catch (e) {\n      Notifications(\"error\", \"ERROR\", e);\n    }\n\n    await clearfields();\n  }\n\n  useEffect(() => {\n    if (wallet.secretjs == null || wallet.address == null) {\n      setupKeplrfun();\n    }\n\n    if (inputBalance != 0) {\n      SetIsUnbondButtonEnabled(true);\n    } else {\n      SetIsUnbondButtonEnabled(false);\n    }\n\n    if (inputBalance * 1e6 > props.delegated) {\n      SetIsUnbondButtonEnabled(false);\n    }\n  }, [wallet, inputBalance, props.delegated]);\n\n  async function onInputchange(e) {\n    setinputBalance(e.target.value);\n  }\n\n  async function clearfields() {\n    await props.callback();\n    props.hide();\n    setinputBalance(0);\n    setIsUnbonding(false);\n  }\n\n  const UM = ({ isShowing, hide }) =>\n    isShowing\n      ? ReactDOM.createPortal(\n          <React.Fragment>\n            <Modal\n              isOpen={isShowing}\n              onRequestClose={hide}\n              contentLabel=\"Example Modal\"\n              style={customStyles}\n              ariaHideApp={false}\n            >\n              <div className=\"flex flex-col h-full justify-between\">\n                <div>\n                  <div className=\"flex flex-row justify-between items-center\">\n                    <div className=\"\">\n                      <span className=\"deposit-modal-heading\">Unbond</span>\n                    </div>\n                    <div className=\"btn-close white\">\n                      <button\n                        type=\"Button\"\n                        className=\"btn-close white\"\n                        aria-label=\"Close\"\n                        onClick={clearfields}\n                      ></button>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-row justify-between items-center   text-white font-light\">\n                  <span className=\"text-white font-light\">\n                    This will remove your SCRT tokens from the rewards contract.\n                    You will have to withdraw your SCRT to see it in your wallet\n                  </span>\n                </div>\n\n                <div className=\"flex flex-row items-center   text-white p-4 border mt-4\">\n                  <div className=\"flex flex-col d mr-4\">\n                    <span className=\"deposit-modal-heading\">&#9888;</span>\n                  </div>\n                  <div className=\"\">\n                    <div className=\"ul\">\n                      Once the unbonding period begins you will:\n                      <div className=\"li\">\n                        - not be able to cancel the unbonding\n                      </div>\n                      <div className=\"li\">\n                        - need to wait 21 days for the amount to be liquid\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-row  justify-between items-center mt-4\">\n                  <div className=\"\">\n                    <span className=\"deposit-modal-available text-m\">\n                      Available\n                    </span>\n                  </div>\n                  <div className=\"flex flex-row \">\n                    <div className=\"d-flex align-items-center m-1\">\n                      <img\n                        src={logo}\n                        alt=\"LOGO Image\"\n                        className=\"img-fluid mini-logo-size\"\n                      />\n                    </div>\n                    <div className=\"ps-1 pool_past_prizes m-1\">\n                      {props.delegated / 1e6} SCRT\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                  className=\"flex flex-row  justify-between items-center  p-2\n              mt-2 deposit-modal-deposit-field deposit-modal-deposit-field-shape \"\n                >\n                  <div>\n                    <input\n                      className=\"deposit-modal-deposit-field text-white w-full\"\n                      type=\"number\"\n                      min=\"0\"\n                      placeholder=\"0.00\"\n                      placeholder-default=\"white\"\n                      name=\"inputBalance\"\n                      value={inputBalance}\n                      onChange={onInputchange}\n                    />\n                  </div>\n                  <div className=\"deposit-modal-deposit-field-tokens\">SCRT</div>\n                </div>\n                <div className=\"flex flex-row mt-4 items-center justify-between text-white \">\n                  <div\n                    className=\"deposit-modal-amount-percentage px-5 \"\n                    onClick={() => {\n                      setinputBalance(\n                        ((props.delegated / 1e6) * 0.25).toFixed(2)\n                      );\n                    }}\n                  >\n                    <button>25%</button>\n                  </div>\n                  <div\n                    className=\"deposit-modal-amount-percentage  px-5\"\n                    onClick={() => {\n                      setinputBalance(\n                        ((props.delegated / 1e6) * 0.5).toFixed(2)\n                      );\n                    }}\n                  >\n                    <button>50%</button>\n                  </div>\n                  <div\n                    className=\"deposit-modal-amount-percentage px-5 \"\n                    onClick={() => {\n                      setinputBalance(\n                        ((props.delegated / 1e6) * 0.75).toFixed(2)\n                      );\n                    }}\n                  >\n                    <button>75%</button>\n                  </div>\n                  <div\n                    className=\"deposit-modal-amount-percentage  px-5\"\n                    onClick={() => {\n                      setinputBalance((props.delegated / 1e6).toFixed(6));\n                    }}\n                  >\n                    <button>100%</button>\n                  </div>\n                </div>\n                <div className=\"btn    \">\n                  <Button\n                    className=\"btn account_deposit_button text-white self-center\"\n                    onClick={() => unbond()}\n                    disabled={!isUnbondButtonEnabled}\n                  >\n                    {isUnbonding ? (\n                      <div className=\"loader-1 center\">\n                        <span>.</span>\n                      </div>\n                    ) : (\n                      <div>Unbond</div>\n                    )}\n                  </Button>\n                </div>\n              </div>\n            </Modal>\n          </React.Fragment>,\n          document.body\n        )\n      : null;\n  return <UM isShowing={props.isShowing} hide={props.hide} />;\n}\n\nexport default UnbondingModal;\n"],"sourceRoot":""}